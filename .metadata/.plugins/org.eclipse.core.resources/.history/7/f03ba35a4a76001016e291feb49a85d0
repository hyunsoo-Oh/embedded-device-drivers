/*
 * ap.c
 *
 *  Created on: Aug 10, 2025
 *      Author: jweli
 */

#include "ap.h"
#include "usart.h"

#include "mpu6050.h"

int16_t accel[3], gyro[3];
float accel[3], gyro[3];
float temp;

char msg[128];

void apInit(void)
{
	MPU6050_Init();
}

void apMain(void)
{
	while (1)
	{
		MPU6050_ReadAccel(accel);
		MPU6050_ReadGyro(gyro);
		MPU6050_ReadTemp(&temp);

		snprintf(msg, sizeof(msg),
			 "ACC: X=%d Y=%d Z=%d | GYRO: X=%d Y=%d Z=%d | TEMP=%.2f\r\n",
			 accel[0], accel[1], accel[2],
			 gyro[0], gyro[1], gyro[2],
			 temp / 340.0f + 36.53f
		);

		HAL_UART_Transmit(&huart2, (uint8_t *)msg, strlen(msg), 100);
}
}
